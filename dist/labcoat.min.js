var labcoat=function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}var _registry=__webpack_require__(1);var registry=_interopRequireWildcard(_registry);var _stylesApa=__webpack_require__(2);var _stylesApa2=_interopRequireDefault(_stylesApa);var _stylesMla=__webpack_require__(4);var _stylesMla2=_interopRequireDefault(_stylesMla);var _stylesOrders=__webpack_require__(6);var orders=_interopRequireWildcard(_stylesOrders);var _transformsBody=__webpack_require__(7);var _transformsBody2=_interopRequireDefault(_transformsBody);var _transformsDiagrams=__webpack_require__(8);var _transformsDiagrams2=_interopRequireDefault(_transformsDiagrams);var _transformsEndnotes=__webpack_require__(11);var _transformsEndnotes2=_interopRequireDefault(_transformsEndnotes);var _transformsCitations=__webpack_require__(12);var _transformsCitations2=_interopRequireDefault(_transformsCitations);var _transformsIdempotentiate=__webpack_require__(15);var _transformsIdempotentiate2=_interopRequireDefault(_transformsIdempotentiate);function transpiler(markup){if(!markup)return markup;var content=(0,_transformsBody2["default"])(markup);if(typeof content!=="string"||!content)return markup;return markup.replace(content,(0,_transformsIdempotentiate2["default"])((0,_transformsDiagrams2["default"])((0,_transformsCitations2["default"])((0,_transformsEndnotes2["default"])(content.replace(/\s+/g," "))))))}transpiler.style=function(style){if(!style)return;if(!style.name)throw new Error("Styles must be registered with a name.");if(style["extends"]){(function(){var extended=registry.get("styles",style["extends"]);if(!extended)throw new Error(style["extends"]+" does not exist.");delete extended.name;Object.keys(style.full).forEach(function(type){return extended[type]=style.full[type]});if(style.inText)extended.inText=style.inText;if(style.order)extended.order=orders[style.order];registry.set("styles",style.name,extended)})()}else{registry.set("styles",style.name,{inText:style.inText,full:style.full,order:orders[style.order]})}};transpiler.style(_stylesApa2["default"]);transpiler.style(_stylesMla2["default"]);exports["default"]=transpiler;(function(_){if(typeof module!=="undefined"&&module.exports)return;document.addEventListener("DOMContentLoaded",function(){var transpiled=transpiler(document.body.innerHTML);if(transpiled!==document.body.innerHTML){document.body.innerHTML=transpiled}})})();module.exports=exports["default"]},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.set=set;exports.get=get;var INVALID_TYPE="There is no registry pool of the specified type.";var INVALID_NAME="You must provide a name to register a value.";var INVALID_VALUE="You must register a value.";var reg={styles:{}};function set(type,name,value){if(!type||!reg[type])throw new Error(INVALID_TYPE);if(!name)throw new Error(INVALID_NAME);if(!value)throw new Error(INVALID_VALUE);reg[type][name]=value}function get(type,name){if(typeof reg[type]==="undefined")throw new Error(INVALID_TYPE);if(typeof reg[type][name]==="undefined")return null;return reg[type][name]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}var _full=__webpack_require__(3);var full=_interopRequireWildcard(_full);exports["default"]={full:full,name:"apa",order:"alphabetical",inText:"~AUTHOR|~EDITOR|TITLE YEAR"};module.exports=exports["default"]},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var book="^AUTHOR. (YEAR). <i>TITLE</i> (TRANSLATOR,+Trans.), (EDITION+ed.) . "+"EDITOR+(Ed(s).). LOCATION: PUBLISHER . PAGECOUNT+pgs.";var bookChapter="^AUTHOR. (YEAR). CHAPTER. In<i>TITLE</i>, EDITOR, (TRANSLATOR,+Trans.), "+"(EDITION+ed.) . LOCATION: PUBLISHER . pp.+PAGENUMBERS.";var anthology="^EDITOR (Ed.). (YEAR). <i>TITLE</i>, (EDITION+ed.) . LOCATION: PUBLISHER . "+"PAGECOUNT+pgs.";var journal='^AUTHOR. (YEAR). "TITLE". JOURNAL. VOLUME(ISSUE). PAGENUMBERS.';var conference="^AUTHOR. (YEAR). TITLE. In+EDITOR, <i>PROCEEDINGS</i>. Paper+presented+at"+"+CONFERENCE ,+CONFLOCATION (PAGENUMBERS). LOCATION: PUBLISHER.";var webpage="^AUTHOR. (DATE). TITLE. <i>WEBSITE</i>. Retrieved:+RETRIEVED. From+URL.";var newspaper="^AUTHOR. (YEAR, DATE). TITLE. <i>NEWSPAPER</i>, pp.+PAGENUMBERS. "+"Retrieved+from+URL.";var magazine="^AUTHOR. (YEAR, DATE). TITLE. <i>MAGAZINE</i>, VOLUME(ISSUE), PAGENUMBERS.";var lecture="^AUTHOR. (YEAR). TITLE [FILEFORMAT]. Retrieved+from+URL";var film="^PRODUCER+(Producer),+&amp; ^DIRECTOR+(Director). (YEAR). TITLE [Motion+"+"Picture]. LOCATION: STUDIO.";var broadcast="^AUTHOR,+&amp; DIRECTOR+(Director). (YEAR). PROGRAMTITLE [Series "+"episode]. In+PRODUCER+(Executive+Producer), SERIESTITLE. LOCATION: CHANNEL.";exports.book=book;exports.bookChapter=bookChapter;exports.anthology=anthology;exports.journal=journal;exports.conference=conference;exports.webpage=webpage;exports.newspaper=newspaper;exports.magazine=magazine;exports.lecture=lecture;exports.film=film;exports.broadcast=broadcast},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}var _full=__webpack_require__(5);var full=_interopRequireWildcard(_full);exports["default"]={full:full,name:"mla",order:"alphabetical",inText:"~AUTHOR|~EDITOR|TITLE PAGES"};module.exports=exports["default"]},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var book="^AUTHOR. <i>TITLE</i> (TRANSLATOR,+Trans.), (EDITION+ed.) . "+"EDITOR+(Ed(s).). LOCATION: PUBLISHER, YEAR. MEDIUM.";var bookChapter="^AUTHOR. CHAPTER. In<i>TITLE</i>, EDITOR, (TRANSLATOR,+Trans.), "+"(EDITION+ed.) . LOCATION: PUBLISHER, YEAR . PAGENUMBERS.";var anthology="^EDITOR (Ed.). <i>TITLE</i>, (EDITION+ed.) . LOCATION: PUBLISHER, YEAR . "+"PAGENUMBERS.";var journal='^AUTHOR. "TITLE." <i>JOURNAL</i>. VOLUME.ISSUE (YEAR) : PAGENUMBERS.';var conference="^AUTHOR. (YEAR). TITLE. In+EDITOR, <i>PROCEEDINGS</i>. Paper+presented+at"+"+CONFERENCE ,+CONFLOCATION (PAGENUMBERS). LOCATION: PUBLISHER.";var webpage='^AUTHOR. "TITLE." <i>WEBSITE</i>, DATE YEAR. MEDIUM. RETRIEVED &lt;URL&gt;.';var newspaper='^AUTHOR. "TITLE." <i>NEWSPAPER</i>, YEAR, DATE : PAGENUMBERS. MEDIUM.';var magazine='^AUTHOR. "TITLE." <i>MAGAZINE</i>, YEAR, DATE : PAGENUMBERS. MEDIUM.';var lecture="^AUTHOR. TITLE [FILEFORMAT]. DATE YEAR . &lt;URL&gt;.";var film="^PRODUCER+(Producer),+&amp; ^DIRECTOR+(Director). (YEAR). TITLE [Motion+"+"Picture]. LOCATION: STUDIO.";var broadcast="^AUTHOR,+&amp; DIRECTOR+(Director). (YEAR). PROGRAMTITLE [Series "+"episode]. In+PRODUCER+(Executive+Producer), SERIESTITLE. LOCATION: CHANNEL.";exports.book=book;exports.bookChapter=bookChapter;exports.anthology=anthology;exports.journal=journal;exports.conference=conference;exports.webpage=webpage;exports.newspaper=newspaper;exports.magazine=magazine;exports.lecture=lecture;exports.film=film;exports.broadcast=broadcast},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.alphabetical=alphabetical;exports.appearance=appearance;function alphabetical(a,b){if(a.author)a=a.author[0].toLowerCase();else if(a.title)a=a.title[0].toLowerCase();if(b.author)b=b.author[0].toLowerCase();else if(b.title)b=b.title[0].toLowerCase();if(a===b)return 0;if([a,b].sort()[0]===a)return-1;return 1}function appearance(){return 0}},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var rTranspiled=/labcoat-transpiled/;exports["default"]=function(markup){return rTranspiled.test(markup)?null:markup};module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _numberingRoman=__webpack_require__(9);var _numberingRoman2=_interopRequireDefault(_numberingRoman);var _numberingLatin=__webpack_require__(10);var _numberingLatin2=_interopRequireDefault(_numberingLatin);var rDiagram=/<diagram\s*?([^>]*?)\s*?>([\s\S]*?)<\/diagram\s*?>/g;var rCaption=/<diagcaption\s*?>([\s\S]*?)<\/diagcaption\s*?>/;var rDiag=/<diag\s*?([^>]*?)\s*?\/>/g;var rDiagId=/<diag\s*?([^>]*?)\s*?\/>/;function numerals(markup){if(/latin-diagrams/.test(markup))return _numberingLatin2["default"];if(/roman-diagrams/.test(markup))return _numberingRoman2["default"];return function(int){return int.toString()}}function transpileCaption(diagram,num){var diagcaption=diagram.match(rCaption);if(!diagcaption)return"";diagcaption=diagcaption[0].replace(rCaption,"$1");return'<figcaption>\n      <span class="figure-label">Figure&nbsp;'+num+"</span>&nbsp;"+diagcaption+"\n    </figcaption>"}function getDiagramNumberById(diagrams,id){var number="?";diagrams.forEach(function(diagram){if(diagram.id===id)number=diagram.number.toString()});return number}function transpileDiagrams(markup){var numbering=numerals(markup||"");var diagrams=markup.match(rDiagram)||[];diagrams=diagrams.map(function(diagram,i){return{index:i,markup:diagram,number:numbering(i+1),id:diagram.replace(rDiagram,"$1").replace(/\s/g,"")}});diagrams.forEach(function(diagram){var caption=transpileCaption(diagram.markup,diagram.number);var inner=diagram.markup.replace(rDiagram,"$2").replace(rCaption,caption);var figure='<figure id="figure-'+diagram.number+'">'+inner+"</figure>";markup=markup.replace(diagram.markup,figure)});return{markup:markup,model:diagrams}}function transpileDiags(markup,diagrams){var diags=markup.match(rDiag)||[];diags=diags.map(function(diag){return{id:diag.replace(rDiagId,"$1").replace(/\s/g,""),markup:diag}});diags.forEach(function(diag){var number=getDiagramNumberById(diagrams,diag.id);var intext='<a class="figure-reference" href="#figure-'+number+'">'+number+"</a>";markup=markup.replace(diag.markup,intext)});return markup}function transpile(markup){var diagramsDone=transpileDiagrams(markup);return transpileDiags(diagramsDone.markup,diagramsDone.model)}exports["default"]=function(markup){try{return transpile(markup)}catch(err){return markup+"\n<!-- "+"Labcoat transpilation failed for <diagram>, <diagcaption>, and <diag /> "+"elements. "+"\n"+err.stack+"\n"+" -->"}};module.exports=exports["default"]},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var key=["","c","cc","ccc","cd","d","dc","dcc","dccc","cm","","x","xx","xxx","xl","l","lx","lxx","lxxx","xc","","i","ii","iii","iv","v","vi","vii","viii","ix"];function romanNumbering(num){if(typeof num!=="number")return"";var digits=num.toString().split("");var roman="";var i=3;while(i--){roman=(key[+digits.pop()+i*10]||"")+roman}return Array(+digits.join("")+1).join("m")+roman}romanNumbering["class"]="roman-numbering";romanNumbering.style="list-style:lower-roman;";exports["default"]=romanNumbering;module.exports=exports["default"]},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var alphabet="-abcdefghijklmnopqrstuvwxyz".split("");function latinNumbering(int){return typeof int==="number"?alphabet[int%26]:undefined}latinNumbering["class"]="latin-numbering";latinNumbering.style="list-style:lower-latin;";exports["default"]=latinNumbering;module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _numberingRoman=__webpack_require__(9);var _numberingRoman2=_interopRequireDefault(_numberingRoman);var _numberingLatin=__webpack_require__(10);var _numberingLatin2=_interopRequireDefault(_numberingLatin);var rEndNote=/<endnote[^>]*?>[\s\S]*?<\/endnote\s*?>/g;var rEndNotes=/<endnotes\s?([^>]*?)\s*?\/>/;function numerals(markup){var matches=markup.match(rEndNotes);if(matches){var num=matches[0].replace(rEndNotes,"$1");if(num==="latin")return _numberingLatin2["default"];if(num==="roman")return _numberingRoman2["default"]}return function(int){return int.toString()}}function transpile(markup){var notes=markup.match(rEndNote)||[];var numbering=numerals(markup);notes.forEach(function(note,index){var num=numbering(index+1);var ref='<sup><a id="intext-note-'+num+'" href="#endnote-'+num+'">'+num+"</a></sup>";markup=markup.replace(note,ref)});var li=notes.map(function(note){return note.replace(/<\/?endnote\s*>/g,"")}).map(function(note,i){var num=numbering(i+1);return'<li><a id="endnote-'+num+'" href="#intext-note-'+num+'">'+note+"</a></li>"});var footer='\n    <section class="endnotes">\n      <ol\n        class="endnotes-list '+(numbering["class"]||"")+'"\n        style="'+(numbering.style||"")+'">\n          '+li.join("")+"\n      </ol>\n    </section>\n  ";return markup.replace(rEndNotes,footer)}exports["default"]=function(markup){try{return transpile(markup)}catch(err){return markup+"\n<!-- "+"Labcoat transpilation failed for <endnote> and <endnotes /> elements. "+"\n"+err.stack+"\n"+" -->"}};module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj["default"]=obj;return newObj}}var _registry=__webpack_require__(1);var registry=_interopRequireWildcard(_registry);var _citeFormat=__webpack_require__(13);var _citeFormat2=_interopRequireDefault(_citeFormat);var rBib=/<bibliography\s*([^>]*?)\s*>([\s\S]*?)<\/bibliography\s?>/;var rCitation=/<citation\s([^>]+?)\s?\/>/g;function duckType(source){if(!source.type)source.type="book"}function full(source,style){duckType(source);var format=style.full[source.type];try{return'<li id="'+source.id+'">'+(0,_citeFormat2["default"])(source,format)+"</li>"}catch(err){return"\n<!-- Failed to interpolate citation "+source.id+". \n"+err.stack+"\n -->\n"}}function inText(source,style){try{return'<cite class="in-text-citation">\n        <a href="#'+source.id+'">'+(0,_citeFormat2["default"])(source,style.inText)+"</a>\n      </cite>"}catch(err){return"\n<!-- Failed to interpolate citation "+source.id+". \n"+err.stack+"\n -->\n"}}function mapBibData(bib){var obj={};bib.forEach(function(source){if("id"in source)obj[source.id]=source});return obj}function getBibData(markup){var output=[];var bib=undefined;if(rBib.test(markup)){bib=markup.match(rBib)[0].replace(rBib,"$2").replace(/(^\s*\[)|(\]\s*$)/g,"").replace(/({|,)\s*([A-z0-9_-]+):/g,'$1"$2":').replace(/,\s*}/g,"}");if(!bib)return output;bib.split(/}[^{]*{/g).forEach(function(record){if(!/^\s*{/.test(record))record="{"+record;if(!/}\s*$/.test(record))record+="}";try{output.push(JSON.parse(record))}catch(err){output.push({input:record,err:err})}});output=mapBibData(output)}return output}function getStyle(markup){var style=markup.match(rBib).shift().replace(rBib,"$1")||"apa";var theStyle=registry.get("styles",style);return theStyle||registry.get("styles","apa")}function transpile(markup){var matches=markup.match(rCitation);if(!matches)return markup;var bib=getBibData(markup);var style=getStyle(markup);var refs=matches.map(function(element){var id=element.replace(rCitation,"$1");var source=bib[id]||{id:id};markup=markup.replace(element,inText(source,style));return source});refs=refs.filter(function(item,i){return refs.indexOf(item)===i});refs.sort(style.order);var li=refs.map(function(source){return full(source,style)});var bibSection='<section id="bibliography">\n      <ol class="bibliography-list">'+li.join("")+"</ol>\n    </section>";return markup.replace(rBib,bibSection)}exports["default"]=function(markup){try{return transpile(markup)}catch(err){return markup+"\n<!-- "+"Labcoat transpilation failed for <citation> and <bibliography /> "+"elements. "+"\n"+err.stack+"\n"+" -->"}};module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _namesList=__webpack_require__(14);var _namesList2=_interopRequireDefault(_namesList);var FIELD=/([A-Z^|~]{3,100})/g;var CARROT=/^\^/;var TILDE=/~/;var BAR=/\|/g;var NAMES=/^(authors?|editors?|translators?|contributors?|composers?|directors?|performers?)$/;function clone(source){var obj={};if(typeof source!=="object")return{};Object.keys(source).forEach(function(key){obj[key]=source[key]});return obj}function getValue(fieldname,source){var invertAll=true;var long=true;var value=null;if(BAR.test(fieldname)){var fields=fieldname.split(BAR);fields.some(function(name){var key=name.replace(CARROT,"").replace(TILDE,"");if(typeof source[key]!=="undefined"){fieldname=name;return true}})}if(TILDE.test(fieldname)){long=false;fieldname=fieldname.replace(TILDE,"")}if(CARROT.test(fieldname)){invertAll=false;fieldname=fieldname.replace(CARROT,"")}value=source[fieldname];delete source[fieldname];if(NAMES.test(fieldname))value=(0,_namesList2["default"])(value,invertAll,long);return value||"EMPTY"}function punctuationFilter(_x){var _again=true;_function:while(_again){var inStr=_x;_again=false;var outStr=inStr.replace(/,+/g,",").replace(/,([.)\]])/g,"$1").replace(/([(\[]),/g,"$1").replace(/\.+/g,".").replace(/\(\./g,".").replace(/\[\./g,"]").replace(/:+/g,":").replace(/:\./g,".").replace(/:,/g,",").replace(/:\)/g,")").replace(/\(:/g,"(").replace(/:\]/g,"]").replace(/\[:/g,"[").replace(/:([^\s\/])/g,": $1").replace(/\(\s/g,"(").replace(/\s\)/g,")").replace(/\[\s/g,"[").replace(/\s\]/g,"]").replace(/,([^\s])/g,", $1").replace(/\s([\.,:])/g,"$1").replace(/\s+$/,"").replace(/^[\[\],.:()\s]+/g,"").replace(/[,:(\[\s]+$/g,"");if(inStr!==outStr){_x=outStr;_again=true;outStr=undefined;continue _function}return outStr}}exports["default"]=function(data,format){var source=undefined,fields=undefined;if(!data||!format)return"";format=format.replace(/\+/g,"__").replace(FIELD,"@@$1@@");fields=format.match(FIELD);if(!fields)return"";source=clone(data);fields.forEach(function(field){var fieldname=field.toLowerCase();var value=getValue(fieldname,source)||"EMPTY";format=format.replace(field,value).replace(/[^\s@|]*@@EMPTY@@[^\s@|]*/g,"")});return punctuationFilter(format.replace(/@@|\|/g,"").replace(/__/g," ").replace(/\s+/g," ").replace(/(\s*\.)+/g,"."))};module.exports=exports["default"]},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function order(a,b){if(a.toLowerCase()>b.toLowerCase())return 1;if(a.toLowerCase()<b.toLowerCase())return-1;return 0}function invertName(name){var split=name.split(", ");if(split[0]&&split[1]){return split[1]+" "+split[0]}else{return name}}function longNames(people,invertAll){return people.map(function(person,index){if(index>0||invertAll)person=invertName(person);if(index===0)return person;if(index>0&&index<people.length-1){return", "+person}else if(index===people.length-1){return" &amp; "+person}}).join("")}function shortNames(people){if(!people||!people.length)return[];people=people.map(function(person){if(/,/.test(person))return person.split(", ")[0];return person});if(people.length===1){return people[0]}else if(people.length===2){return people[0]+" &amp; "+people[1]}else if(people.length>2){return people[0]+" et al."}}exports["default"]=function(people,invertAll,long){if(!people)return"";people=people.split(" and ");people=people.sort(order);if(long)return longNames(people,invertAll);return shortNames(people)};module.exports=exports["default"]},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=function(markup){return markup+="<!--labcoat-transpiled-->"};module.exports=exports["default"]}]);
